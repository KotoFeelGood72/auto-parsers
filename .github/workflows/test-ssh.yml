name: Test SSH Connection

on:
  workflow_dispatch: # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é
  push:
    branches: [ main, master ]

jobs:
  test-ssh:
    runs-on: ubuntu-latest
    
    steps:
    - name: Test SSH Connection
      uses: appleboy/ssh-action@v1.0.3
      with:
        host: ${{ secrets.SERVER_HOST }}
        username: ${{ secrets.SERVER_USER }}
        key: ${{ secrets.SERVER_SSH_KEY }}
        port: ${{ secrets.SERVER_PORT || 22 }}
        timeout: 60s
        script: |
          echo "üîç Testing SSH connection..."
          echo "User: $(whoami)"
          echo "Directory: $(pwd)"
          echo "Date: $(date)"
          echo "‚úÖ SSH connection successful!"
          
    - name: Test Project Directory
      uses: appleboy/ssh-action@v1.0.3
      with:
        host: ${{ secrets.SERVER_HOST }}
        username: ${{ secrets.SERVER_USER }}
        key: ${{ secrets.SERVER_SSH_KEY }}
        port: ${{ secrets.SERVER_PORT || 22 }}
        timeout: 60s
        script: |
          echo "üîç Testing project directory..."
          cd /root/auto-parsers || {
            echo "‚ùå Directory not found"
            exit 1
          }
          echo "üìÅ Project directory: $(pwd)"
          echo "üìã Contents:"
          ls -la
          echo "‚úÖ Project directory accessible!"
