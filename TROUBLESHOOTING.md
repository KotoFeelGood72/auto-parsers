# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º CI/CD

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. **npm test –ø–∞–¥–∞–ª**
- **–ü—Ä–æ–±–ª–µ–º–∞**: `npm test` –≤–æ–∑–≤—Ä–∞—â–∞–ª –æ—à–∏–±–∫—É "no test specified"
- **–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω —Å–∫—Ä–∏–ø—Ç test –≤ package.json –Ω–∞ `echo 'No tests configured yet' && exit 0`

### 2. **SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ**
- **–ü—Ä–æ–±–ª–µ–º–∞**: `ssh: handshake failed: EOF`
- **–†–µ—à–µ–Ω–∏–µ**: 
  - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –≤ GitHub Actions
  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  - –î–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è

## üöÄ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω package.json**
```json
{
  "test": "echo 'No tests configured yet' && exit 0",
  "test:syntax": "find src -name '*.js' -exec node -c {} \\;",
  "test:config": "node -e \"const { getCreateTablesSQL } = require('./src/database/schema'); console.log('Schema OK:', getCreateTablesSQL().length, 'tables');\""
}
```

### 2. **–£–ª—É—á—à–µ–Ω GitHub Actions workflow**
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã: `timeout: 300s`, `command_timeout: 300s`
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å `set -e`
- –î–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 3. **–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä**
- `deploy.sh` - —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
- `docker-compose.prod.yml` - –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –§–∞–π–ª—ã —Å–¥–µ–ª–∞–Ω—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏

### 4. **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π workflow**
- `.github/workflows/test-ssh.yml` - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ GitHub Actions

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
ssh -i ~/.ssh/id_rsa_server root@77.232.138.181 "echo 'SSH OK'"

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/auto-parsers
ls -la
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ GitHub Secrets:
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `SERVER_HOST`: `77.232.138.181`
- `SERVER_USER`: `root`
- `SERVER_SSH_KEY`: [–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á]
- `SERVER_PORT`: `22` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### 1. **–¢–µ—Å—Ç SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Actions ‚Üí Test SSH Connection
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow –≤—Ä—É—á–Ω—É—é
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

### 2. **–¢–µ—Å—Ç –¥–µ–ø–ª–æ—è**
- –°–¥–µ–ª–∞–π—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ
- Commit –∏ push –≤ main –≤–µ—Ç–∫—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Actions ‚Üí Deploy to Server

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–î–æ–±–∞–≤—å—Ç–µ GitHub Secrets** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç SSH** —á–µ—Ä–µ–∑ Actions
3. **–°–¥–µ–ª–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π push** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–ø–ª–æ—è
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫

## üÜò –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è:

### SSH –ø—Ä–æ–±–ª–µ–º—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –∫–ª—é—á –ª–æ–∫–∞–ª—å–Ω–æ
ssh -i ~/.ssh/id_rsa_server root@77.232.138.181 "whoami"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la ~/.ssh/id_rsa_server*
```

### GitHub Actions –ø—Ä–æ–±–ª–µ–º—ã:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Actions
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å BEGIN/END —Å—Ç—Ä–æ–∫–∏)

### –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh -i ~/.ssh/id_rsa_server root@77.232.138.181 "docker --version && docker-compose --version"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
ssh -i ~/.ssh/id_rsa_server root@77.232.138.181 "cd /root/auto-parsers && pwd && ls -la"
```

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
1. ‚úÖ npm test –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
2. ‚úÖ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
